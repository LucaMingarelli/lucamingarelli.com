<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Oribi Analytics -->
  <script type="application/javascript">
    (function(b,o,n,g,s,r,c){if(b[s])return;b[s]={};b[s].scriptToken="XzgzMjUyODI5Ng";b[s].callsQueue=[];b[s].api=function(){b[s].callsQueue.push(arguments);};r=o.createElement(n);c=o.getElementsByTagName(n)[0];r.async=1;r.src=g;r.id=s+n;c.parentNode.insertBefore(r,c);})(window,document,"script","https://cdn.oribi.io/XzgzMjUyODI5Ng/oribi.js","ORIBI");
  </script>
  <!-- End Oribi Analytics -->
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NLJ2P23');</script>
  <!-- End Google Tag Manager -->
  <meta charset="utf-8"/>
  <title>Luca Mingarelli</title>
  <link rel="icon" href="/Icons/stork.png" type="image/png">
  <style>
    .collapsible {background-color: #777;color: white;cursor: pointer;  padding: 2px;width: 100%;
      border: none;  text-align: left;  outline: none;  font-size: 15px; border-radius: 2px;}
    /*.active,*/
    .collapsible:hover {  background-color: #555;}
    .content {display: none;  overflow: hidden;  background-color: #DCDCDC;}
  </style>

</head>

<!--<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>-->
<script>window.MathJax = {tex: {tags: 'ams'}};</script>
<script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_SVG"></script>-->

<link rel="stylesheet" href="/PRISM/prism.css"> <!-- For code highlight -->
<script src="/PRISM/prism.js"></script>         <!-- For code highlight -->


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/w3.css">
<link rel="stylesheet" href="/css/font.css">
<link rel="stylesheet" href="/css/responsiveiframe.css">
<script src="/js/style_preamble.js"></script>

<body class="w3-light-grey w3-content" style="max-width:2600px">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NLJ2P23"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<!-- NavigationBar -->
<script src="/js/Navbar.js"></script>
<!-- _____________ -->
<!-- PRE_CONTENT -->
<script src="/js/pre_content.js"></script>
<!-- _____________ -->


<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v5.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

<!-- and it's easy to individually load additional languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/julia.min.js"></script>

<script>hljs.highlightAll();</script>


<div class="w3-content w3-justify" style="max-width:800px">

  <h1 style="text-align: left;"><b>Macro-Economic Modelling 2</b></h1>

<h2 style="text-align: left;"><b>Short Term Dynamics: Fluctuations and the Business Cycle </b></h2>


The previous chapter has focused on long-term dynamics and the process of capital accumulation.
One is however often interested in the short-term dynamics of <i>business cycles</i>, 
that is fluctuations in output and employment around a long-term trend. 
<!-- Therefore, business cycle analysis is concerned with determining the drivers or impulses and their propagation (responses) -->
<br>

Some stylised facts characterising the expansions and contractions of the business cycle are:

<ol>
  <li>Fluctuations are recurrent but with no trivial cyclical pattern, and hence hard to predict</li>
  <li>Persistence of both expansions and contractions through time</li>
  <li>Employment and consumptions are procyclical, that is they co-move with output</li>
  <li>Real wages exhibit little fluctuation with and are only weakly procyclical if at all</li>
  <li></li>
</ol>


Number 1 implies that...

<figure>
  <img class="center" alt="growth"
       src="./BC.svg"
       width="100%" >
  <figcaption><i><b>Fig.1:</b> Business cycles in main US macroeconomic aggregates. 
    Deviations from the trend are extracted via Hodrick-Prescott filters with \(\lambda=1600\). 
    Details on series in <a href="#ref1">[1]</a>.
  </i></figcaption>
</figure>






<br>
By and large there exist two main schools of thought ...

<br>
The idea that business cycles are driven by technological changes 
dates back to Schumpeter (1939) <a href="#ref2">[2]</a>




<figure>
  <img class="center" alt="growth"
       src="./BC_periodogram_multi.svg"
       width="85%" >
  <figcaption><i><b>Fig.2:</b> Spectrum of output and unemployment business cycles.

    The spectrum is smoothed via convolution with a Hamming kernel.
  </i></figcaption>
</figure>












  <h3 style="text-align: left;"><b>The Real Business Cycle model</b></h3>

The so called <i>Real busiless cycle model </i>  (RBC) was introduced 
in 1982 by Kydland and Prescott <a href="#ref3">[3]</a> building on a discrete-time version of the neoclassical growth model framework.
Crucially however, uncertainty is introduced 
in the form of exhogenous productivity shocks, so that log-productivity \(\log(A_t)\)
follows the \(AR(1)\) process

\begin{equation}
\label{eq:productivity_process}
\log(A_{t+1}) = \varphi \log(A_{t}) +\varepsilon_{t+1}.
\end{equation}


Moreover, a choice between the fraction of time devoted to
labour \(l_t\) and leisure \(h_t\) is also introduced 
with the natural constraint \(l_t+h_t = 1\).

We consider a Cobb-Douglas per-capita production function 
\begin{equation}
f(k_t, l_t, A_t) = A_t k_t^\alpha l_t^{1-\alpha},
\end{equation}
with as usual \(\alpha\) being the output elasticity of capital.

Because of the stochasticity of 
the productivity process \eqref{eq:productivity_process} 
consumers will aim at maximising <i>expected</i> utility, 
so that the optimisation problem reads
\begin{equation}
\label{eq:rbc_opt_problem}
\boxed{
\begin{split}
&\max_{c_t, h_t}\mathbb{E}\left[\sum_t\beta^t\left((1-\eta)u(c_t)+\eta\nu(h_t)\right)\right]\\
&\phantom{xxx}\text{subject to}\\
&k_{t+1} = l_t w_t + (1+r_t)k_t - c_t
\end{split}
}
\end{equation}
with \(\beta\) the discount factor.
Notice that the household has two control variables: consumption \(c_t\) and leisure \(h_t\).
Here \(0 < \eta < 1\) is a mixing parameter determining 
the relative relevance of consumption utility versus leisure utility in the total utility function ...

<br>
Problem \eqref{eq:rbc_opt_problem} has Bellman equation

\begin{equation}
V(k_t) = \max_{}\Bigl\{(1-\eta)u(c_t)+\eta\nu(h_t)+\beta\mathbb{E}\left[V(k_{t+1})\right]\Bigr\}.
\end{equation}
For convenience, denote the right-hand side argument 
of \eqref{eq:opt_rbc_bellman} by \(\overline{V}_t = (1-\eta)u(c_t)+\eta\nu(h_t)+\beta\mathbb{E}\left[V(k_{t+1})\right]\).

Notice that 
 \begin{equation}
 \frac{d \overline{V}_t}{d c_t} = (1-\eta)u'(c_t)-\beta\mathbb{E}[V'(k_{t+1})],
\end{equation}

so that \(\overline{V}_t\) is maximised with respect to consumption \(c_t\) for

\begin{equation}
\label{eq:opt_rbc_bellman}
\beta \mathbb{E}[V'(k_{t+1})] = (1-\eta)u'(c_t).
\end{equation}

Then, observe that
\begin{equation}
\label{eq:V_prime}
\frac{d \overline{V}_t}{d k_t} = \beta\mathbb{E}[V'(k_{t+1})](1+r_t). 
\end{equation}
Thus,  \(V'(k_{t+1}) = (1-\eta)u'(c_{t+1})(1+r_{t+1})\),
and from \eqref{eq:opt_rbc_bellman} one has

\begin{equation}
\begin{split}
u'(c_t) &= \beta\frac{\mathbb{E}[V'(k_{t+1})]}{1-\eta}\\
        &=\beta\frac{1}{1-\eta}\mathbb{E}[(1-\eta)u'(c_{t+1})(1+r_{t+1})]\\
        &=\beta(1+r_{t+1})\mathbb{E}[u'(c_{t+1})]
\end{split}\quad .
\end{equation}


Similarly, for labour-leisure choice one has

\begin{equation}
\label{eq:opt_rbc_bellman2}
\frac{d V(k_t)}{d h_t} = \eta\nu'(h_t)-\beta\mathbb{E}[V'(k_{t+1})]w_t = 0,
\end{equation}

meaning that \(\beta\mathbb{E}[V'(k_{t+1})] = \eta\nu'(h_t) / w_t\).

Therefore, putting this result together with \eqref{eq:V_prime}:
\begin{equation}
V'(k_{t+1}) = \frac{\eta\nu'(h_{t+1})}{w_{t+1}} (1+r_{t+1})
\end{equation}
and
\begin{equation}
\begin{split}
\nu'(h_t) &= \frac{w_t}{\eta}\beta\mathbb{E}[V'(k_{t+1})]\\
          &= (1+r_{t+1})\beta\mathbb{E}[\frac{w_t}{w_{t+1}}\nu'(h_{t+1})]
\end{split}\quad.
\end{equation}
That is to say, the Euler equations are:

\begin{equation}
\label{eq:rbc_euler_equations}
\begin{split}
u'(c_t) &= (1+r_{t+1})\beta\mathbb{E}[u'(c_{t+1})],\\
\nu'(h_t) &= (1+r_{t+1})\beta\mathbb{E}[\frac{w_t}{w_{t+1}}\nu'(h_{t+1})].
\end{split}
\end{equation}


Furthermore, notice that \eqref{eq:opt_rbc_bellman} and \eqref{eq:opt_rbc_bellman2} taken together imply

\begin{equation}
\label{eq:rbc_labour_supply0}
(1-\eta)u'(c_t)w_t = \eta\nu'(h_t) = \eta\nu'(1-l_t),
\end{equation}

which provides an equation for the supply of labour \(l_t\).

<br>
In order to clarify the meaning of this result it is useful to look at 
the deterministic case with log-utility:

\begin{equation}
U(c_t, h_t) = (1-\eta)u(c_t) + \eta \nu(h_t) = (1-\eta)\log(c_t) + \eta \log(h_t).
\end{equation}

In this case, equations \eqref{eq:rbc_euler_equations} become

\begin{equation}
\begin{split}
\frac{c_{t+1}}{c_{t}} &= (1+r_{t+1})\beta,\\
\frac{h_{t+1}}{h_{t}} &= (1+r_{t+1})\beta\frac{w_t}{w_{t+1}}.
\end{split}
\end{equation}

Therefore, higher wages increase the supply of labour proportionally to the level of interest rates.

The labout supply \eqref{eq:rbc_labour_supply0} then reads

\begin{equation}
\label{eq:rbc_labour_supply}
l_t = 1-\frac{\eta}{1-\eta} \frac{c_t}{w_t}.
\end{equation}

Notice that the labour-leisure choice is therefore static, 
being determined in each specific period from only concurrent states.
<br>
The RBC model is therefore specified by the dynamical system:

\begin{equation} 
\label{eq:RBC_system_of_dyn_eqs}
\begin{cases}
    y_t = A_t k_t^\alpha  l_t^{1-\alpha}, & \text{Production function}\\
    r_t = \alpha A k_t^{\alpha-1}l^{1-\alpha} - \delta, & \text{Real Rate of Interest}\\
    w_t = (1-\alpha)y_t, & \text{Wage}\\
    c_{t+1} = \beta(1+r_{t+1}) c_t, & \text{Euler Equation for Consumption}\\
    k_{t+1} = (1 - r_t)k_t + l_tw_t - c_t, & \text{Equation of Motion for Capital}\\
    l_t = 1-\frac{\eta}{1-\eta} \frac{c_t}{w_t}, & \text{Labour Supply}\\
    \log(A_{t+1}) = \varphi \log(A_{t}) +\varepsilon_{t+1}, & \text{Log-Productivity AR(1) process}
\end{cases}
\end{equation}

Systems like \eqref{eq:RBC_system_of_dyn_eqs} do not admit 
closed form solutions, so that the standard approach is to employ perturbation
methods around the non-stochastic steady state, 
and by log-linearisation. 
<br>
The core idea, for a given state \(x_t\), 
is to consider the steady state \(\overline{x}\) 
and the log deviation from it \(\hat{x}_t\equiv\log\left(\frac{x_t}{\overline{x}}\right)\),
so that one can write 
\begin{equation}
x_t = \overline{x}e^{\hat{x}_t} = \overline{x}(1+\hat{x}_t) + \mathcal{O}(\hat{x}_t^2),
\end{equation}

where the power series expansion has been truncated to first order, but can in principle be taken at arbitrarily higher orders. 

<br> 
Here we will solve the model through the convenient Julia library <i><a href="https://thorek1.github.io/MacroModelling.jl/stable">Macromodelling.jl</a></i> <a href="#ref4">[4]</a>.

<pre><code class="lang-julia">
using MacroModelling
import StatsPlots

@model RBC begin
  r[0] = α * A[0] * k[0]^(α-1) * ℓ[0]^(1-α) - δ    # Real Rate of Interest
  w[0] = (1-α) * y[0]                              # Wage: Marginal Product of Labour
  c[1] / c[0] = β * (1+r[1])                       # Euler Equation for Consumption
  k[0] = (1 - r[-1]) * k[-1] + ℓ[-1]*w[-1] - c[-1] # EoM
  ℓ[0] = 1-η/(1-η) * c[0] / w[0]                   # Labout Supply
  y[0] = A[0] * k[0]^α * ℓ[0]^(1-α)                # Production Function
  log(A[0]) = ϕ * log(A[-1]) + σᶻ * ε[x]           # AR(1) 
end

@parameters RBC begin
  σᶻ= 0.00763
  ϕ = 0.9
  δ = 0.025
  α = 0.36
  β = 0.99
  η = 0.497
end
</code></pre>

The associated impulse-response functions, 
describing the evolution of the (non-stochastic) system
upon a shock can now be simply obtained as

<pre><code class="lang-julia"></code>
plot_irf(RBC, periods=150)
</code></pre>
<figure>
  <img class="center" alt="growth"
       src="./RBC_IRF.svg"
       width="100%" >
  <figcaption><i><b>Fig.3:</b> Impulse-response functions for the RBC model.
  </i></figcaption>
</figure>














  <h3 style="text-align: left;"><b>The New Keynesian model</b></h3>






<br><br>
  <h4 id="REFERENCES"><i>References and notes</i></h4>

  [1] <span id="ref1"> GDP: <a href="https://fred.stlouisfed.org/series/GDP" style="font-size: smaller;">GDP</a>;
  Investment (Gross Private Domestic Investment): <a href="https://fred.stlouisfed.org/series/GPDI" style="font-size: smaller;">GPDI</a>;
  Wage per Hour (Average Hourly Earnings of Production and Nonsupervisory Employees, Total Private): <a href="https://fred.stlouisfed.org/series/AHETPI" style="font-size: smaller;">AHETPI</a>;
  Hours worked (Nonfarm Business Sector: Hours Worked for All Workers): <a href="https://fred.stlouisfed.org/series/HOANBS" style="font-size: smaller;">HOANBS</a>;
  UNRATE: <a href="https://fred.stlouisfed.org/series/UNRATE" style="font-size: smaller;">UNRATE</a>;
  TFP (Total Factor Productivity): <a href="https://www.frbsf.org/research-and-insights/data-and-indicators/total-factor-productivity-tfp/" style="font-size: smaller;">Federal Reserve Bank of San Francisco</a>, quarterly TFP.
  </span>
  <br><br>  
  [2] <a href="https://discoversocialsciences.com/wp-content/uploads/2018/03/schumpeter_businesscycles_fels.pdf" id="ref2">"Business Cycles: A Theoretical, Historical, and Statistical Analysis of the Capitalist Process",  Joseph Alois Schumpeter (1939). </a>
  <br><br>
  [3] <a href="https://www.jstor.org/stable/1913386" id="ref3">"Time to Build and Aggregate Fluctuations", Finn E. Kydland, Edward C. Prescott, Econometrica, Vol. 50, No. 6 (1982) </a>
  <br><br>
  [4] <a href="https://joss.theoj.org/papers/10.21105/joss.05598" id="ref4">"MacroModelling.jl: A Julia package for developing and solving dynamic stochastic general equilibrium models", T. Kockerols, (2023), Journal of Open Source Software, 8(89), 5598, https://doi.org/10.21105/joss.05598. </a>
  <br><br>

      <br>

<!--  https://bookdown.org/egarpor/NP-UC3M/kde-ii-asymp.html-->
<!--  https://bookdown.org/egarpor/NP-EAFIT/intro-nonpar.html-->

<!--  https://bookdown.org/egarpor/inference/-->
<!--  https://bookdown.org/egarpor/PM-UC3M/-->


  <br><br>

  <!-- ________________________________________________________________________________________________ -->
  <!-- ________________________________________________________________________________________________ -->
  <!-- ________________________________________________________________________________________________ -->
  <!--    <h7>-->
  <!-- <span style="float:right;">
 <a href="./L2.html"><b><img src="../Icons/next.png" width="20px" align="right">Next</b></a>
 </span>
 </h7>
 <br> -->

  <h5> <a href="/Teaching.html"><b><img src="/Icons/back.png" width="20px"> Back to Teaching</b></a></h5>



  <hr class="w3-opacity">
</div>
</div>
<script type="text/javascript" src="/js/footer.js"></script>

<!-- End page content -->
</div>

<script src="/js/OpenCloseSidebar.js"></script>
<!--<script src="../js/ModalImageGallery.js"></script>-->
<script src="/js/OpenCloseCollapsible.js"></script>

</body>
</html>
