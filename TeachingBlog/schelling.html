<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Luca Mingarelli</title>
  <link rel="icon" href="../Icons/stork.png" type="image/png">
  <style>
    .collapsible {background-color: #777;color: white;cursor: pointer;  padding: 2px;width: 100%;
      border: none;  text-align: left;  outline: none;  font-size: 15px; border-radius: 2px;}
    /*.active,*/
    .collapsible:hover {  background-color: #555;}
    .content {display: none;  overflow: hidden;  background-color: #DCDCDC;}
  </style>
</head>

<!--<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>-->
<script>window.MathJax = {tex: {tags: 'ams'}};</script>
<script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_SVG"></script>-->

<link rel="stylesheet" href="prism/prism.css"> <!-- For code highlight -->
<script src="prism/prism.js"></script>         <!-- For code highlight -->


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../css/w3.css">
<link rel="stylesheet" href="../css/font.css">
<link rel="stylesheet" href="../css/responsiveiframe.css">
<script src="../js/style_preamble.js"></script>

<body class="w3-light-grey w3-content" style="max-width:2600px">
<!-- NavigationBar -->
<script src="js/Navbar.js"></script>
<!-- _____________ -->
<!-- PRE_CONTENT -->
<script src="js/pre_content.js"></script>
<!-- _____________ -->




<div class="w3-content w3-justify" style="max-width:800px">

  <h1 style="text-align: left;"><b>Schelling's Model of Racial Segregation</b></h1>

  Racial residential segregation has existed for centuries and across different
  societies, often actively enforced by law. This was for example the case in the
  19th century's United States with the
  <a href="https://en.wikipedia.org/wiki/Jim_Crow_laws">Jim Crow laws</a>.
  When the U.S. Supreme Court declared them unconstitutional in 1954,
  many expected segregation would disappear. This however was not the case:
  to the contrary, despite much effort and investment, segregation still remains
  a major issue in the U.S. and elsewhere to this date <a href="#ref1">[1]</a>.

  <figure>
    <img class="center" alt="copulae_grid"
         src="img/Schelling/Segregation_in_Chicago.png"
         width="100%" >
    <br>
    <figcaption><i><b>Fig.1:</b> Racial residential segregation in Chicago according to the 2010 census <a href="#ref2">[2]</a>.
      Check out the  Weldon Cooper Center for Public Service
      at the University of Virginia for a full
      <a href="http://racialdotmap.demographics.coopercenter.org">
        map of ratial segregation in the United States</a>.
    </i></figcaption>
  </figure>
 Even in absence of laws enforcing segregation,
  this can be caused by a number of factors including housing and loan discrimination,
  prejudice, etc. Yet another factor however, one which was not considered at the time,
    is that of <i>emergence</i>, that is the existence of macro-characteristics
    which is generated by the micro-level interaction of a complex system's
    constituents. In 1971, Thomas Schelling devised one of the earliest examples
    of agent-based models<a href="#ref3">[3]</a> suggesting that segregation could arise even when
    individuals would not mind being surrounded by different races, as long as they
    still desire to have at least a small fraction of people of the same racial background
    as neighbours. Despite the agents' willingness to accept a more diverse neighbourhood,
    segregation emerges nonetheless from the social interactions of different individuals.
    Strikingly, even weak local preferences can lead to major global phenomena
    emerging from the network of individual micro-interactions.
    Moreover, these emergent macro-regularities feed back upon the individual agents,
    constraining their choices and behaviour.


    <h2 style="text-align: left;"><b>A simple model of segregation</b></h2>


One of the simplest versions of Schelling's segregation model
    consists in a stylised representation of a residential area
    where individuals repeatedly make relocation decisions
    based on the characteristics of their immediate neighborhood.
<br>
    The model considers two types of agents,
    say <i style="color:blue;"><b>blue</b></i>
    and  <i style="color: red;"><b>red</b></i>,
    which might represent different races, ethnicities, economic status, etc.,
    and a \(N\times N\) grid of residential locations over which a number \(N_a\le N^2\) of agents are initially randomly
    allocated. The agents' population is characterised by the fraction
    \(N_{b/r} = N_b / N_r\) of blue to red types such that \(N_a = N_b + N_r\),
    and assumed to be constant, so that at any given time
    one will have \(N_v = N^2 - N_a\) vacant residential locations.
    Each agent \(i\) is then characterised by a <i>satisfaction parameter</i>
    \(S_i\) given by the fraction of neighbours of the same type.
    Notice that the number of neighbours might depend on whether one considers
    fixed or periodic boundary conditions as well as on vacant locations
    which are not counted in the computation of \(S_i\).
    <figure>
        <img class="center" alt="copulae_grid"
             src="img/Schelling/schelling_grid1.svg"
             width="80%" >
        <br>
        <figcaption><i><b>Fig.2:</b> Neighbourhoods of two agents \(i\)
            and \(j\) for fixed or periodic boundary conditions.
        </i></figcaption>
    </figure>

    <h4 style="text-align: left;"><b>Dynamics</b></h4>

The dynamics is set by a global <i>tolerance parameter</i> \(\tau\)
    denoting the maximum fraction of neighbours of a different type
    each agent is willing to accept before it decides to relocate.
    Therefore, every agent with \(S_i < 1 - \tau\) will relocate at random into a different
    vacant residential location. The dynamics continues until a stable equilibrium
    is found (if it exists) where all agents are satisfied.
    <br>
    Alternative versions of the model might consider a different behaviour
    whereby dissatisfied agents would move to the closest vacant location,
    instead of a random one, or to the best available location,
    or to the nearest location meeting the threashold \(1-\tau\).
    <br>
As a consequence individuals' decisions are based exclusively on personal
    considerations based on the characteristics of the local neighbourhood they currently reside in.
    However, the act of relocation, despite being based on local parameters,
    ends up having global effect, since the random relocation of one agent might
    make discontent other agents which were previously satisfied.

    <h4 style="text-align: left;"><b>Simulations</b></h4>

    In the following we employ a Python implementation
    of Schelling's segregation model on an \(N\times N\) grid with \(N=60\),
    assuming \(10\%\) of all properties being vacant at any given time,
    a \(1\)-to-\(1\) ratio of red to blue agents.
Let us start by defining the system's parameters:
    <pre><code class="lang-python">
N = 60       # Grid will be N x N
SIM_T = 0.4  # Similarity threshold (that is 1-Ï„)
EMPTY = 0.1  # Fraction of vacant properties
B_to_R = 1   # Ratio of blue to red people</code></pre>

    In order to maintain high efficiency in the simulations
    we shall model the system
    as a <code>numpy.array</code> of size <code>(N, N)</code>,
    encoding residential locations occupied by blue agents as <code>0</code>,
    those occupied by red agents as <code>1</code>,
    and vacant properties as <code>-1</code>.
    <br>
    Now one needs two main functions: a <code>rand_init</code> function
    for the random initialisation of the system matrix <code>M</code>, and a <code>evolve</code> function
    to impose on the system the dynamics described above.
    The former is easily implemented as
    <pre><code class="lang-python">import numpy as np

def rand_init(N, B_to_R, EMPTY):
    """ Random system initialisation.
    BLUE  =  0
    RED   =  1
    EMPTY = -1
    """
    vacant = N * N * EMPTY
    population = N * N - vacant
    blues = int(population * 1 / (1 + 1/B_to_R))
    reds = population - blues
    M = np.zeros(N*N, dtype=np.int8)
    M[:reds] = 1
    M[-vacant:] = -1
    np.random.shuffle(M)
    return M.reshape(N,N)</code></pre>

The following Fig. 3 presents as example of a randomly initialised system,
    with the parameters specified above.
    <figure>
        <img class="center" alt="copulae_grid"
             src="img/Schelling/schelling_grid_init.svg"
             width="80%" >
        <br>
        <figcaption><i><b>Fig.3:</b> Random initialisation with high degree of integration.
        </i></figcaption>
    </figure>


The evolution function instead is where most of the computational effort lies,
    and more specifically in the computation
    of the satisfaction parameters \(S_i\).
    For a fast implementation we can rely on convolution of the matrix
    <code>M</code> with the kernel
    <pre><code class="lang-python">
KERNEL = np.array([[1, 1, 1],
                   [1, 0, 1],
                   [1, 1, 1]], dtype=np.int8)</code></pre>
    The convolution operation on a kernel
    \(K\in\mathbb{R}^{(2k_x+1)\times (2k_y+1)}\)
    is defined as
    <div style="overflow-x: scroll;">
    \[
(K\star M)_{i,j} = \sum_{\substack{
        a\in\{-k_x,\ ...,\ k_x\}\\
        b\in\{-k_y,\ ...,\ k_y\}}}
 K_{a+k_x,b+k_y}\ M_{i+a,j+b}.
    \]
</div>
Therefore, each element of the convolution \(K\star M\) contains the sum
    of all neighbouring values.
    <br>
    With this in mind, we can now write a function to take care of the dynamical
    evolution of the system:

    <pre><code class="lang-python">from scipy.signal import convolve2d

def evolve(M, boundary='wrap'):
    """
    Args:
        M (numpy.array): the matrix to be evolved
        boundary (str): Either wrap, fill, or pad
    If the similarity ratio of neighbours
    to the entire neighborhood population
    is lower than the SIM_T,
    then the individual moves to an empty house.
    """
    kws = dict(mode='same', boundary=boundary)
    B_neighs = convolve2d(M == 0, KERNEL, **kws)
    R_neighs = convolve2d(M == 1, KERNEL, **kws)
    Neighs   = convolve2d(M != -1,  KERNEL, **kws)

    B_dissatified = (B_neighs / Neighs < SIM_T) & (M == 0)
    R_dissatified = (R_neighs / Neighs < SIM_T) & (M == 1)
    M[R_dissatified | B_dissatified] = - 1
    vacant = (M == -1).sum()

    N_B_dissatified, N_R_dissatified = B_dissatified.sum(), R_dissatified.sum()
    filling = -np.ones(vacant, dtype=np.int8)
    filling[:N_B_dissatified] = 0
    filling[N_B_dissatified:N_B_dissatified + N_R_dissatified] = 1
    np.random.shuffle(filling)
    M[M==-1] = filling</code></pre>

    Notice that the <code>boundary</code> argument of
    <code>scipy.signal.convolve2d</code> provides an easy way to switch
    from fixed (<code>'fill'</code>) to periodic (<code>'wrap'</code>) boundary conditions.
    In the following we shall stick to the latter.
<br>
Finally we are able to run simulations.

    <figure>
        <img class="center" alt="copulae_grid"
             src="img/Schelling/animation.svg"
             width="80%" >
        <br>
        <figcaption><i><b>Fig.4:</b>
            System's evolution for \(1-\tau=0.6\).
        </i></figcaption>
    </figure>


    <figure>
        <img class="center" alt="copulae_grid"
             src="img/Schelling/schelling_params.svg"
             width="80%" >
        <br>
        <figcaption><i><b>Fig.5:</b>
            Some equilibria of the system for increasing intolerance.
        </i></figcaption>
    </figure>














  <br>

  <h4 id="REFERENCES"><i>References</i></h4>

  [1] <a href="https://tcf.org/content/commentary/racial-segregation-is-still-a-problem/" id="ref1">"Racial Segregation Is Still a Problem", Michael Cassidy, The Century Foundation, July 2013 </a>
  <br>
  [2] <a href="https://demographics.coopercenter.org/racial-dot-map" id="ref2">"The Racial Dot Map", Demographics Research Group, Weldon Cooper Center for Public Service, University of Virginial, 2017 </a>
  <br>
  [3] <a href="https://www.stat.berkeley.edu/~aldous/157/Papers/Schelling_Seg_Models.pdf" id="ref3">"Dynamic Models of Segregation", Thomas C. Schelling, Journal of Mathematical Sociology, 1971, Vol.1, pp143-186</a>
  <br>
  [4] <a href="" id="ref4"> </a>

  <br><br>

  <!-- ________________________________________________________________________________________________ -->
  <!-- ________________________________________________________________________________________________ -->
  <!-- ________________________________________________________________________________________________ -->
  <!--    <h7>-->
  <!-- <span style="float:right;">
 <a href="./L2.html"><b><img src="../Icons/next.png" width="20px" align="right">Next</b></a>
 </span>
 </h7>
 <br> -->

  <h5> <a href="../Teaching.html"><b><img src="../Icons/back.png" width="20px"> Back to Teaching</b></a></h5>



  <hr class="w3-opacity">
</div>
</div>
<script type="text/javascript" src="../js/footer.js"></script>

<!-- End page content -->
</div>

<script src="../js/OpenCloseSidebar.js"></script>
<!--<script src="../js/ModalImageGallery.js"></script>-->
<script src="../js/OpenCloseCollapsible.js"></script>

</body>
</html>
